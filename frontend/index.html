<!-- frontend/index.html -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Live DDoS Map</title>
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
  <style>body { margin:0; } #map { width:100vw; height:100vh; }</style>
</head>
<body>
<div id="map"></div>
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<script>
mapboxgl.accessToken = 'YOUR_MAPBOX_TOKEN';
const map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/dark-v11',
    center: [0, 20],
    zoom: 1.5
});

async function updateMap() {
    const res = await fetch('http://localhost:8000/events');
    const data = await res.json();XMLDocument
    const features = data.map(d => ({
        type: 'Feature',
        geometry: { type: 'Point', coordinates: [/* lon */, /* lat */] },
        properties: { mag: d.value }
    }));
    if (map.getSource('attacks')) {
        map.getSource('attacks').setData({ type: 'FeatureCollection', features });
    } else {
        map.addSource('attacks', { type: 'geojson', data: { type: 'FeatureCollection', features } });
        map.addLayer({
            id: 'attacks-layer',
            type: 'circle',
            source: 'attacks',
            paint: {
                'circle-radius': ['interpolate', ['linear'], ['get', 'mag'], 0, 2, 1000, 20],
                'circle-color': '#ff4136',
                'circle-opacity': 0.6
            }
        });
    }
}

map.on('load', () => {
    updateMap();
    setInterval(updateMap, 60000);
});
</script>
</body>
</html>
